<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{% if page.title %}{{ page.title }} | {% endif %}{{ site.title }}</title>
  <meta name="description" content="{{ site.description }}">
  <link rel="stylesheet" href="{{ '/assets/css/style.css' | relative_url }}">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  {% feed_meta %}
</head>
<body>

  {% if page.url == '/' %}
  <div class="boot-overlay" id="bootOverlay">
    <div class="boot-screen">
      <div id="bootLines"></div>
      <div class="boot-progress-line" id="bootProgressLine" style="display:none">
        <span>> loading profile [</span><span class="boot-progress-track"><span class="boot-progress-bar" id="bootBar"></span></span><span>] <span id="bootPct">0</span>%</span>
      </div>
      <p id="bootReady" style="display:none">> <span class="boot-ok">ready.</span><span class="boot-cursor">_</span></p>
    </div>
  </div>
  <script>
    (function() {
      var CHAR_MS = 20;
      var GAP_MS = 80;
      var BAR_MS = 2500;
      var seq = [
        { text: '> initializing system...' },
        { text: '> loading modules... ', ok: true },
        { text: '> establishing connection... ', ok: true }
      ];
      var container = document.getElementById('bootLines');
      var lineIdx = 0, charIdx = 0, curEl = null, okEl = null;

      function createLine() {
        var p = document.createElement('p');
        p.className = 'boot-line';
        curEl = document.createElement('span');
        p.appendChild(curEl);
        if (seq[lineIdx].ok) {
          okEl = document.createElement('span');
          okEl.className = 'boot-ok';
          okEl.textContent = '[OK]';
          okEl.style.opacity = '0';
          p.appendChild(okEl);
        } else { okEl = null; }
        container.appendChild(p);
        charIdx = 0;
      }

      function typeChar() {
        var line = seq[lineIdx];
        if (charIdx < line.text.length) {
          curEl.textContent = line.text.substring(0, charIdx + 1);
          charIdx++;
          setTimeout(typeChar, CHAR_MS);
        } else {
          if (okEl) okEl.style.opacity = '1';
          lineIdx++;
          if (lineIdx < seq.length) {
            setTimeout(function() { createLine(); typeChar(); }, GAP_MS);
          } else {
            setTimeout(startBar, GAP_MS);
          }
        }
      }

      function startBar() {
        var progLine = document.getElementById('bootProgressLine');
        var bar = document.getElementById('bootBar');
        var pct = document.getElementById('bootPct');
        progLine.style.display = 'flex';
        var start = null;
        function step(ts) {
          if (!start) start = ts;
          var p = Math.min((ts - start) / BAR_MS, 1);
          var e = p < 0.5 ? 2*p*p : 1 - Math.pow(-2*p+2, 2)/2;
          bar.style.width = (e * 100) + '%';
          pct.textContent = Math.floor(e * 100);
          if (p < 1) { requestAnimationFrame(step); }
          else { setTimeout(showReady, 100); }
        }
        requestAnimationFrame(step);
      }

      function showReady() {
        document.getElementById('bootReady').style.display = 'block';
        setTimeout(function() {
          document.getElementById('bootOverlay').classList.add('boot-fade');
        }, 400);
        setTimeout(function() {
          document.getElementById('bootOverlay').style.display = 'none';
          revealContent();
        }, 900);
      }

      function revealContent() {
        var g = document.querySelector('.hero-greeting');
        if (g) g.classList.add('animate');
        var steps = [
          { sel: '.hero-name', delay: 700 },
          { sel: '.hero-tagline', delay: 750 },
          { sel: '.hero-terminal', delay: 850 },
          { sel: '.section:nth-child(2)', delay: 1100 },
          { sel: '.section:nth-child(3)', delay: 1400 }
        ];
        steps.forEach(function(s) {
          setTimeout(function() {
            var el = document.querySelector(s.sel);
            if (el) el.classList.add('show');
          }, s.delay);
        });
      }

      setTimeout(function() { createLine(); typeChar(); }, 200);
    })();
  </script>
  {% endif %}

  <nav class="navbar">
    <div class="nav-inner">
      <a href="{{ '/' | relative_url }}" class="nav-logo">
        <span class="prompt">$</span> {{ site.title | default: "ta-tsu150" }}
      </a>
      <div class="nav-links">
        <a href="{{ '/' | relative_url }}" class="nav-link {% if page.url == '/' %}active{% endif %}">
          <span class="prompt">~</span> Home
        </a>
        <a href="https://github.com/ta-tsu150" class="nav-link" target="_blank" rel="noopener">
          <span class="prompt">~</span> GitHub
        </a>
      </div>
    </div>
  </nav>

  <main class="content">
    {{ content }}
  </main>

  <footer class="footer">
    <div class="footer-inner">
      <p class="footer-text">
        <span class="prompt">$</span> echo "Built with Jekyll & GitHub Pages"
      </p>
      <p class="footer-copy">&copy; {{ site.time | date: '%Y' }} {{ site.title | default: "ta-tsu150" }}</p>
    </div>
  </footer>

</body>
</html>
